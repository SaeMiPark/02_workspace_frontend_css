<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <style>
        * {
            box-sizing: border-box;
        }

        div {
            border: 1px solid black;
        }

        .con {
            width: 700px;
            height: 200px;
            border: 1px solid black;
            margin: auto;
        }

        .row {
            display: flex;
        }

        .col {
            display: flex;
            flex-direction: column;
        }

        .row1box {
            flex: 1;
            background-color: gray;
        }

        .row1box>input {
            height: 100%;
        }

        .row2box {
            flex: 3;
        }

        .textbox {
            flex: 7;
        }

        .replaybox {
            flex: 3;
            display: flex;
            justify-content: center;
            align-items: center;
        }
    </style>

</head>

<body>
    <div class="con col">
        <div class="row row1box">
            <input id="writer" type="text" placeholder="작성자명을 입력해주세요.">
        </div>
        <div class="row row2box">
            <div id="txts" class="textbox" contenteditable="true"></div>
            <div class="replaybox">Reply</div>
        </div>
    </div>
    <hr>

    <script>
        $(".replaybox").on("click", function () {
            //전체 박스
            let dcon = $("<div>").addClass("con");
            dcon.css({
                "width": "700px",
                "height": "200px",
                "border": "1px solid black",
                "margin": "auto",
                "display": "flex"
            });

            //div col1
            let col1 = $("<div>");
            col1.css({
                "flex": "7",
                "padding": "3px",
            })

            //div-col-box
            let col1_box = $("<div>");
            col1_box.css({
                "display": "flex",
                "flex-direction": "column",
                "height": "100%"
            })

            //제목 누구님의 글
            let drow1 = $("<div>");
            drow1.css({
                "flex": "1",
                "background-color": "gray",
                "display": "flex",
                "align-items": "center"
            })
            drow1.html($("#writer").val() + " 님의 글");
            $("#writer").val("");

            //내용 
            let drow2 = $("<div>").addClass("drow2");
            drow2.css({
                "flex": "3",
            })
            drow2.html($("#txts").html());
            $("#txts").html("");
            drow2.attr("contenteditable", "false");

            //div col2 버튼 2개 담을
            let col2 = $("<div>");
            col2.css({
                "flex": "3",
                "display": "flex",
                "justify-content": "space-evenly",
                "align-items": "center"
            })

            //수정버튼
            let modifybtn = $("<button>");
            modifybtn.html("수정");

            //삭제버튼
            let delbtn = $("<button>");
            delbtn.html("삭제");
            
            let contents;
            
            //수정 버튼 기능
            modifybtn.on("click", function () {
                let frontbtn = $(this).text();
                let backbtn = $(this).next().text();

                // 수정 버튼 클릭 시 현재 내용 저장
                contents = $(this).closest(".con").find(".drow2").html();

                if (frontbtn == "완료") {
                    $(this).closest(".con").find(".drow2").attr("contenteditable", "false");
                }

                //수정을 누르면 완료로 변하게
                if (frontbtn == "수정") {
                    // $(this).closest(".con").find(".drow2").attr("contenteditable","false");
                    $(this).closest(".con").find(".drow2").attr("contenteditable", "true");
                    $(this).text("완료");


                } else {
                    $(this).text("수정");
                }

                //삭제를 누르면 취소로 변하게
                if (backbtn == "삭제") {
                    $(this).next().text("취소");

                } else {
                    $(this).next().text("삭제");

                }

            })

            //삭제 버튼 기능
            delbtn.on("click", function () {
                let backbtn = $(this).text();
                if (backbtn == "취소") {
                    $(this).closest(".con").find(".drow2").html(contents);
                } else {
                    $(this).parent().parent().remove();
                }
            })


            $("hr").append(dcon);
            dcon.append(col1);
            dcon.append(col2);
            col1.append(col1_box);
            col1_box.append(drow1);
            col1_box.append(drow2);
            col2.append(modifybtn);
            col2.append(delbtn);
        })
    </script>




</body>

</html>